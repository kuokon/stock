<div ng-init="svr.title = vm.title ; vm.prevPage = '/'"
     ng-include="'src/ot/view/header.html'"></div>
<div
        ng-include="'src/ot/view/admin/sub-header.html'"></div>


<div ng-init="isInspector = svr.getCurrUser().isInspector()">

    <div ng-show="isInspector" style="text-align: center; font-size: xx-large; margin-top: 10%; color: red">


        調查員 不應訪問 此頁。

        <br/>

        Inspector should not visit this page.

    </div>

    <md-table-container
            ng-show="!isInspector"
            ng-init="hash = svr.getPageHash(); monthRange = svr.getMonthRange(); yearRange=svr.getYearRange();">
        <table md-table>
            <thead md-head>
            <tr md-row>

                <th md-column style="width: 10px; padding: 0" class="box-none">#</th>

                <th md-column style="width: 50px ; ">
                    By

                </th>


                <th md-column style="width: 80%">

                    <md-input-container>
                        <md-select class="box-none" ng-model="vm.pickedHost"
                                   ng-change="vm.onRefreshLog()"
                                   style="margin-top: 0; margin-bottom: 0; ; background: lightsteelblue">
                            <md-option ng-value="kv.value"
                                       ng-repeat="kv in vm.hosts">{{ kv.name }}
                            </md-option>
                        </md-select>

                    </md-input-container>

                    <md-button class="md-fab md-mini md-raised md-primary" ng-click="vm.onRefreshLog()"><i class="fa fa-refresh"></i></md-button>


                    <md-input-container class="box-none" style="margin-left: 10px"
                                        ng-style="{ 'background-color': filter  ? 'orange':''}">
                        <label class="fa fa-search" for="search"></label>
                        <input ng-model="filter" type="text" id="search"

                               ng-model-options="{ allowInvalid: true, debounce: 500 }"/>
                    </md-input-container>



                </th>



                <th md-column style="width: 80px"> At

                    <md-button class="  md-raised md-warn md-hue-1" ng-click="svr.doBackupAll()"><i class="fa fa-cloud"> Backup</i></md-button>
                </th>


            </tr>
            </thead>
            <tbody md-body style="cursor:pointer;">

            <tr md-row style="cursor: pointer; height: 30px; "

                ng-style="{ background:  item.Id ? '':'lightgrey'}"
                ng-repeat="item in vm.getLogs(filter) "
                id="{{item.Id}}"
            >

                <td md-cell style=" color: lightgray; padding: 5px"  >
                    <small>
                        {{ item.Id}}
                    </small>
                </td>

                <td md-cell style="padding: 0">

                    <small>
                        {{ item.UpdateBy}} | {{ svr.mgr.users.get(item.UpdateBy).Name}}
                    </small>
                </td>

                <td md-cell style="max-width: 800px">
                    <small>
                        {{ item.Log}}
                    </small>

                </td>

                <td md-cell >
                    <small>
                        {{ svr.helper.showDate(item.UpdateAt) +' | ' + svr.helper.showTime(item.UpdateAt)}}
                    </small>
                </td>


            </tr>
            </tbody>
        </table>
    </md-table-container>

</div>